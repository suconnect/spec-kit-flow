---

description: "用于功能实现的任务清单模板"
---

# 任务: [FEATURE NAME]

**输入**: 来自 `/specs/[###-feature-name]/` 的设计文档
**前置条件**: plan.md（必需）、spec.md（用户故事必需）、research.md、data-model.md、contracts/

**测试**: 下方示例包含测试任务。测试为可选项——仅当功能规范明确要求时才包含。

**组织方式**: 任务按用户故事分组，以便每个故事可独立实现与测试。

## 格式: `[ID] [P?] [Story] 描述`

- **[P]**: 可并行运行（不同文件、无依赖）
- **[Story]**: 该任务所属的用户故事（如 US1、US2、US3）
- 描述中需包含精确文件路径

## 路径约定

- **单项目**: 仓库根目录下 `src/`、`tests/`
- **Web 应用**: `backend/src/`、`frontend/src/`
- **移动端**: `api/src/`、`ios/src/` 或 `android/src/`
- 下述路径默认假设为单项目结构——请根据 plan.md 调整

<!-- 
  ============================================================================
  重要：以下任务为示例，仅用于说明。
  
  /speckit.tasks 命令必须基于以下内容生成实际任务：
  - spec.md 中的用户故事（含优先级 P1、P2、P3...）
  - plan.md 中的功能需求
  - data-model.md 中的实体
  - contracts/ 中的端点
  
  任务必须按用户故事组织，以便每个故事都可以：
  - 独立实现
  - 独立测试
  - 作为 MVP 增量交付
  
  生成的 tasks.md 文件中请勿保留这些示例任务。
  ============================================================================
-->

## 阶段 1：初始化（共享基础设施）

**目标**: 项目初始化与基本结构

- [ ] T001 按实施计划创建项目结构
- [ ] T002 使用 [framework] 初始化 [language] 项目与依赖
- [ ] T003 [P] 配置代码规范与格式化工具

---

## 阶段 2：基座能力（阻塞性前置）

**目标**: 必须在任何用户故事实施前完成的核心基础设施

**⚠️ 严格要求**: 未完成本阶段前，禁止开始任何用户故事工作

基座任务示例（请根据实际项目调整）：

- [ ] T004 建立数据库模式与迁移框架
- [ ] T005 [P] 实现认证/授权框架
- [ ] T006 [P] 搭建 API 路由与中间件结构
- [ ] T007 创建所有故事依赖的基础模型/实体
- [ ] T008 配置错误处理与日志基础设施
- [ ] T009 设置环境配置管理

**检查点**: 基座就绪——允许开始并行实施用户故事

---

## 阶段 3：用户故事 1 - [标题]（优先级：P1）🎯 MVP

**目标**: [该故事交付的内容简述]

**独立测试**: [如何独立验证该故事]

### 用户故事 1 的测试（可选——仅当请求测试时）⚠️

> 注意：先编写这些测试，并确保在实现前处于失败状态

- [ ] T010 [P] [US1] 针对 [endpoint] 的契约测试，位于 tests/contract/test_[name].py
- [ ] T011 [P] [US1] 针对 [用户旅程] 的集成测试，位于 tests/integration/test_[name].py

### 用户故事 1 的实现

- [ ] T012 [P] [US1] 在 src/models/[entity1].py 创建 [Entity1] 模型
- [ ] T013 [P] [US1] 在 src/models/[entity2].py 创建 [Entity2] 模型
- [ ] T014 [US1] 在 src/services/[service].py 实现 [Service]（依赖 T012、T013）
- [ ] T015 [US1] 在 src/[location]/[file].py 实现 [端点/功能]
- [ ] T016 [US1] 添加校验与错误处理
- [ ] T017 [US1] 为故事 1 的操作添加日志

**检查点**: 此时，用户故事 1 应可完整独立测试

---

## 阶段 4：用户故事 2 - [标题]（优先级：P2）

**目标**: [该故事交付的内容简述]

**独立测试**: [如何独立验证该故事]

### 用户故事 2 的测试（可选——仅当请求测试时）⚠️

- [ ] T018 [P] [US2] 针对 [endpoint] 的契约测试，位于 tests/contract/test_[name].py
- [ ] T019 [P] [US2] 针对 [用户旅程] 的集成测试，位于 tests/integration/test_[name].py

### 用户故事 2 的实现

- [ ] T020 [P] [US2] 在 src/models/[entity].py 创建 [Entity] 模型
- [ ] T021 [US2] 在 src/services/[service].py 实现 [Service]
- [ ] T022 [US2] 在 src/[location]/[file].py 实现 [端点/功能]
- [ ] T023 [US2]（如需）与用户故事 1 组件集成

**检查点**: 此时，用户故事 1 与 2 均应能独立运行

---

## 阶段 5：用户故事 3 - [标题]（优先级：P3）

**目标**: [该故事交付的内容简述]

**独立测试**: [如何独立验证该故事]

### 用户故事 3 的测试（可选——仅当请求测试时）⚠️

- [ ] T024 [P] [US3] 针对 [endpoint] 的契约测试，位于 tests/contract/test_[name].py
- [ ] T025 [P] [US3] 针对 [用户旅程] 的集成测试，位于 tests/integration/test_[name].py

### 用户故事 3 的实现

- [ ] T026 [P] [US3] 在 src/models/[entity].py 创建 [Entity] 模型
- [ ] T027 [US3] 在 src/services/[service].py 实现 [Service]
- [ ] T028 [US3] 在 src/[location]/[file].py 实现 [端点/功能]

**检查点**: 所有用户故事现在都应可独立运行

---

[根据需要添加更多用户故事阶段，遵循相同模式]

---

## 阶段 N：打磨与跨领域事项

**目标**: 影响多个用户故事的改进

- [ ] TXXX [P] 在 docs/ 补充文档
- [ ] TXXX 代码清理与重构
- [ ] TXXX 跨故事的性能优化
- [ ] TXXX [P]（如请求）在 tests/unit/ 补充单元测试
- [ ] TXXX 安全加固
- [ ] TXXX 运行 quickstart.md 验证

---

## 依赖与执行顺序

### 阶段依赖

- **初始化（阶段 1）**: 无依赖——可立即开始
- **基座能力（阶段 2）**: 依赖阶段 1 完成——阻塞所有用户故事
- **用户故事（阶段 3+）**: 均依赖基座能力完成
  - 具备人力时，可并行实施用户故事
  - 否则按优先级顺序依次实施（P1 → P2 → P3）
- **打磨（最终阶段）**: 依赖所有目标用户故事完成

### 用户故事依赖

- **用户故事 1（P1）**: 可在基座能力（阶段 2）完成后开始——不依赖其他故事
- **用户故事 2（P2）**: 可在基座能力（阶段 2）完成后开始——可与 US1 集成，但应可独立测试
- **用户故事 3（P3）**: 可在基座能力（阶段 2）完成后开始——可与 US1/US2 集成，但应可独立测试

### 每个用户故事内部

- 如包含测试，必须先写测试并在实现前失败
- 先模型，后服务
- 先服务，后端点
- 先核心实现，后集成
- 完成当前故事后再进入下一个优先级

### 并行机会

- 所有标记为 [P] 的初始化任务可并行
- 基座能力阶段中标记为 [P] 的任务可并行（阶段 2 内部）
- 一旦完成基座能力，若团队人力允许，所有用户故事均可并行启动
- 标记为 [P] 的测试可并行
- 同一故事内标记为 [P] 的模型可并行
- 不同用户故事可由不同成员并行推进

---

## 并行示例：用户故事 1

```bash
# 一次性启动用户故事 1 的所有测试（若请求测试）：
Task: "Contract test for [endpoint] in tests/contract/test_[name].py"
Task: "Integration test for [user journey] in tests/integration/test_[name].py"

# 一次性启动用户故事 1 的所有模型：
Task: "Create [Entity1] model in src/models/[entity1].py"
Task: "Create [Entity2] model in src/models/[entity2].py"
```

---

## 实施策略

### 先做 MVP（仅用户故事 1）

1. 完成阶段 1：初始化
2. 完成阶段 2：基座能力（关键——阻塞所有故事）
3. 完成阶段 3：用户故事 1
4. 停止并校验：独立测试用户故事 1
5. 若准备就绪，进行部署/演示

### 渐进式交付

1. 完成 初始化 + 基座能力 → 基座就绪
2. 添加用户故事 1 → 独立测试 → 部署/演示（MVP！）
3. 添加用户故事 2 → 独立测试 → 部署/演示
4. 添加用户故事 3 → 独立测试 → 部署/演示
5. 每个故事都应在不破坏前序故事的前提下增加价值

### 并行团队策略

若有多名开发者：

1. 团队协作完成 初始化 + 基座能力
2. 一旦完成基座能力：
   - 开发者 A：用户故事 1
   - 开发者 B：用户故事 2
   - 开发者 C：用户故事 3
3. 各故事独立完成并集成

---

## 备注

- [P] 任务 = 不同文件、无依赖
- [Story] 标签将任务映射到具体用户故事，便于追踪
- 每个用户故事都应可独立完成与测试
- 实现前请先确保测试失败
- 每个任务或逻辑组完成后提交
- 在任意检查点暂停，以独立验证故事
- 避免：模糊任务、同一文件冲突、破坏独立性的跨故事依赖
