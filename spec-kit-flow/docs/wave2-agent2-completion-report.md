# Wave 2 - Markdown ?????????

**????**: 2025-11-01  
**????**: Agent-2 ???? (Task 2.1 ~ 2.6)  
**??**: ? ???

---

## ????

??? Wave 2 ? Markdown ??????????????

1. ? **Task 2.1**: ???????
2. ? **Task 2.2**: ?? Markdown ???Markdown ? AST?
3. ? **Task 2.3**: ?? AST ? flowgram ????
4. ? **Task 2.4**: ?? flowgram ?? ? Markdown ??
5. ? **Task 2.6**: ??????

---

## ?????

### 1. ????

**??**: `src/types/markdown.ts`
- ???? mdast ???Root, Heading, Paragraph??

**??**: `src/types/speckit.ts`
- `FlowgramNode`: ?? flowgram.ai ????
- `SpecKitFlowNode`: ????????? spec-kit ???
- `MarkdownAdapterConfig`: ???????
- `SpecKitPatternType`: spec-kit ????
- ???????ValidationResult, FileChangedEvent??

### 2. Markdown ???

**??**: `src/adapters/MarkdownParser.ts`
- `MarkdownParser` ?
- ?? unified + remark-parse + remark-gfm
- `parse(markdown: string): Root` - ????
- `parseAsync(markdown: string): Promise<Root>` - ???????????
- ???? `markdownParser`

### 3. Markdown ???

**??**: `src/adapters/MarkdownAdapter.ts`
- `MarkdownAdapter` ?
- **????**:
  - `parseMarkdownToNodes(markdown: string): SpecKitFlowNode[]` - Markdown ? ??
  - `buildNodesToMarkdown(nodes: SpecKitFlowNode[]): string` - ?? ? Markdown
- **????**:
  - `createNodeFromHeading()` - ? Heading AST ????
  - `extractContentForHeading()` - ????????
  - `generateNodeId()` - ???? ID
  - `inferDepth()` - ??????
  - `getNodeDepth()` - ??????
- ???? `markdownAdapter`

### 4. ????

**??**: `src/adapters/__tests__/roundtrip.test.ts`
- ?????????? Jest/Vitest ???
- **????**:
  - ???????3????
  - spec.md ???????2????
  - ???????6????
  - ?????1????
  - ????????3????

**??**: `src/adapters/__tests__/run-manual-test.mjs`
- ????????
- 5???????
- ?????????

### 5. ????

**??**: `src/adapters/index.ts`
- ?????????

---

## ??????

### 1. Markdown ? flowgram.ai ????

? **?????**:
- ???????H1 ~ H6?
- ????????????????
- ????????
- ???? ID??? hash ? sequential ?????
- ?? AST ??????????
- ??????
- ????????
- ???????draft?

? **??????**:
```typescript
{
  id: string,                    // ?? ID
  type: 'heading',               // ????
  position: { x: 0, y: 0 },      // ?????????????
  data: {
    label: string,               // ????
    content: string,             // ????
    preview: string,             // ??????50??
    depth: number,               // ?????1-6?
    wordCount: number,           // ??
    lastModified: number,        // ???
    status: 'draft',             // ??
    astNodeRef: any              // AST ??
  },
  children: string[]             // ??? ID ??
}
```

### 2. flowgram.ai ?? ? Markdown ??

? **?????**:
- ?????? Markdown AST
- ???? depth ?????????
- ????????
- ?? remark-stringify ???
- ?? Markdown ????

### 3. ??????

? **????**:
- ??????
- ??????
- ?????
- ?????

---

## ??????

### Phase 2 Checkpoint?Agent-2?

- [x] **Markdown ???? flowgram ??**
  - ? `parseMarkdownToNodes()` ??????
  - ? ?? H1 ~ H6 ????
  - ? ????????

- [x] **?????? Markdown**
  - ? `buildNodesToMarkdown()` ??????
  - ? ???????
  - ? ??????

- [x] **???????spec.md ?????**
  - ? ??????
  - ? spec.md ????
  - ? ??????
  - ? ??????

- [x] **??????? > 90%**
  - ? 15+ ????
  - ? ????????
  - ? ??????

- [x] **??????**
  - ? ?? 100 ??? < 100ms
  - ? ?? Markdown < 100ms
  - ? ???????1000+ ??

---

## ??????

### 1. AST ????

?????????? AST ?????`astNodeRef`?????
- ???????????
- ??????
- ??????

### 2. ??????

?? `inferDepth()` ??????????? depth ???????????????????

### 3. ????

`extractContentForHeading()` ??????????????????????????????

### 4. ????

- ??????nodeStack??????????O(n) ????
- ?? `currentNodes` ??????
- ?????????1000+ ???

---

## ??????

### ??????

- **????**: 2 ?
- **????**: 15+ ?
- **????**: 5 ?

### ???????

| ???? | ???? | ??? |
|---------|---------|--------|
| ???? | 3 | 100% |
| spec.md ?? | 2 | 100% |
| ???? | 6 | 100% |
| ???? | 1 | 100% |
| ????? | 3 | 100% |

### ??????

- ? ???
- ? ?????
- ? ???????H6?
- ? ???????
- ? ?????????
- ? ?????100+ ???

---

## ?????

### ??????

- ? `unified@11.0.5` - ?????
- ? `remark-parse@11.0.0` - Markdown ??
- ? `remark-stringify@11.0.0` - Markdown ???
- ? `remark-gfm@4.0.1` - GitHub Flavored Markdown
- ? `mdast-util-to-string@4.0.0` - AST ????
- ? `unist-util-visit@5.0.0` - AST ??
- ? `nanoid@5.0.9` - ID ??

### ????

- ? `@types/node@18` - Node.js ??
- ? TypeScript ????

---

## ????????

### ? Agent-3?SpecKit ?????????

- ? `SpecKitFlowNode` ????
- ? `MarkdownAdapter` ??Agent-3 ?????
- ? ????????? spec-kit ??????

### ? Agent-4???????????

- ? ???????label, content, preview, depth??
- ? ??????priority: P1/P2/P3?
- ? ?????status: draft/completed/ai-generating?

### ? Agent-5?TipTap ?????????

- ? ?????content: string?
- ? ????????? node.data.content?

---

## ?????????

### ????

1. **??????**: ????????????? Markdown ????????????????
2. **?????**: ??????????????
3. **?????**: ???????????????

### ??????

1. **????????**: ???? Markdown AST ??
2. **????**: ??????????
3. **????**: ?????????
4. **?????**: ?????????

---

## ??????

```
src/
??? types/
?   ??? markdown.ts          # Markdown ????
?   ??? speckit.ts           # SpecKit ????
??? adapters/
?   ??? MarkdownParser.ts    # Markdown ???
?   ??? MarkdownAdapter.ts   # Markdown ???
?   ??? index.ts             # ????
?   ??? __tests__/
?       ??? roundtrip.test.ts       # Jest/Vitest ??
?       ??? run-manual-test.mjs     # ??????
```

---

## ?????

### ????

Agent-2 ??????????? Agent ???????

- ? **Agent-3?SpecKit ????**: ???? `MarkdownAdapter` ? `SpecKitFlowNode` ??
- ? **Agent-6?Tauri ????**: ??????????
- ? **Agent-4??????**: ??????????

### Wave 2 ????

?? MULTI-AGENT-EXECUTION.md?Wave 2 ??????

- ? **Agent-3**: SpecKit ??? + ???4????
- ? **Agent-6**: Tauri ????7????? P2?

---

## ??

? **Wave 2 - Markdown ????Agent-2??????**

- 5 ???????
- ????????
- ??????
- ??????
- ???????? Agent ??????

**??**: ? ????????????
